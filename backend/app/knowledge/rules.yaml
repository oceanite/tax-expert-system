rules:

  - id: R1
    description: "Tarif progresif lapisan pertama"
    condition: "PKP <= 60000000"
    action:
      tax_rate: 0.05

  - id: R2
    description: "Tarif progresif lapisan kedua"
    condition: "PKP > 60000000 and PKP <= 250000000"
    action:
      tax_rate: 0.15

  - id: R3
    description: "Tarif progresif lapisan ketiga"
    condition: "PKP > 250000000 and PKP <= 500000000"
    action:
      tax_rate: 0.25

  - id: R4
    description: "Tarif progresif lapisan keempat"
    condition: "PKP > 500000000 and PKP <= 5000000000"
    action:
      tax_rate: 0.30

  - id: R5
    description: "Tarif progresif lapisan kelima"
    condition: "PKP > 5000000000"
    action:
      tax_rate: 0.35

  - id: R6
    description: "Sumbangan bukan objek pajak"
    condition: "income_type == 'donation' and related_to_work == false"
    action:
      taxable: false

  - id: R7
    description: "Zakat/infak/sedekah melalui lembaga resmi bukan objek pajak"
    condition: "income_type in ['zakat', 'infak', 'sedekah'] and via_official_institution == true"
    action:
      taxable: false

  - id: R8
    description: "Penghasilan selain kategori pengecualian dianggap kena pajak"
    condition: "income_type in ['salary','business','interest','dividend','royalty','rental','capital_gain','insurance']"
    action:
      taxable: true

  - id: R9
    description: "Jika bukan objek pajak maka pajak final = 0"
    condition: "taxable == false"
    action:
      final_tax: 0

  - id: R10
    description: "Jika kena pajak, hitung final tax"
    condition: "taxable == true"
    action:
      formula: "PKP * tax_rate"

  - id: R11
    description: "Validasi input PKP"
    condition: "PKP < 0"
    action:
      error: "Invalid PKP input"

  - id: R12
    description: "Warisan bukan objek pajak"
    condition: "income_type == 'warisan'"
    action:
      taxable: false

  - id: R13
    description: "Hibah keluarga atau badan keagamaan/pendidikan/sosial bukan objek pajak"
    condition: "income_type in ['hibah_keluarga','hibah_badan_keagamaan','hibah_badan_pendidikan','hibah_badan_sosial']"
    action:
      taxable: false

  - id: R14
    description: "Beasiswa bukan objek pajak"
    condition: "income_type == 'beasiswa'"
    action:
      taxable: false

  - id: R15
    description: "Biaya usaha yang dapat dikurangkan (deductible)"
    condition: "expense_type in ['biaya_operasional','gaji_pegawai','bunga_pinjam','penyusutan','sumbangan_yang_disyaratkan_usaha']"
    action:
      deductible: true

  - id: R16
    description: "Biaya yang tidak dapat dikurangkan (non-deductible)"
    condition: "expense_type in ['dividen_dibagikan','biaya_pribadi','cadangan_non_izin','remunerasi_berlebihan']"
    action:
      deductible: false

  - id: R17
    description: "Hitung net income jika deductible"
    condition: "deductible == true"
    action:
      formula: "net_income = bruto_income - expense_amount"

  - id: R18
    description: "Hitung net income jika non-deductible"
    condition: "deductible == false"
    action:
      formula: "net_income = bruto_income"

  - id: R19
    description: "Kredit pajak luar negeri tersedia"
    condition: "foreign_tax_paid == true"
    action:
      eligible_tax_credit: true

  - id: R20
    description: "Tarif pajak untuk wajib pajak badan (corporate)"
    condition: "taxpayer_type == 'badan'"
    action:
      corporate_tax_rate: 0.28

  - id: R21
    description: "Tarif badan setelah tahun pajak 2010"
    condition: "taxpayer_type == 'badan' and year >= 2010"
    action:
      corporate_tax_rate: 0.25
